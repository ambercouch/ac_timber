{# templates/partials/nav-service.twig #}
{% set defaultImgId = 10 %}
<div class="c-nav-menu c-nav-menu--service">
  <ul class="c-nav-menu__list c-nav-menu__list--service">
    {% for item in menuService.get_items %}
      {% set id          = item._menu_item_object_id %}
      {% set title       = fn('get_field', 'service_title', id) ?: item.title %}
      {% set intro       = fn('get_field', 'service_intro_content', id)
        ?: fn('get_post_field', 'post_excerpt', id) %}
      {% set imgField    = fn('get_field', 'service_image', id) %}
      {% if imgField and imgField.ID %}
        {% set imgId = imgField.ID %}
      {% else %}
        {% set imgId = fn('get_post_thumbnail_id', id) ?: defaultImgId %}
      {% endif %}
      {% set imgSrc      = fn('wp_get_attachment_image_url', imgId, 'serviceMenuLarge') %}
      {% set imgSrcset   = fn('wp_get_attachment_image_srcset', imgId, 'serviceMenuLarge') %}
      {% set imgSizes    = fn('wp_get_attachment_image_sizes', imgId, 'serviceMenuLarge') %}
      {% set iconField   = fn('get_field', 'custom_post_icon', id) %}
      {% set contentFld  = fn('get_field', 'service_content', id) %}
      {% set href        = fn('get_field', 'service_link', id) ?: item.url %}
      {% set linkLabel   = fn('get_field', 'service_link_label', id) ?: 'Find Out More' %}
      {% set hideLink    = fn('get_field', 'hide_service_content_link', id) %}
      {# choose wrapper tag: <a> if not hidden, else <div> #}
      {% set wrapperTag = hideLink ? 'div' : 'a' %}
      <li class="c-nav-menu__item c-nav-menu__item--service">
      <{{ wrapperTag }}
      {% if not hideLink %} href="{{ href }}" title="{{ title }}"{% endif %}
      class="c-nav-menu__link c-nav-menu__link--service"
      >
      <header class="c-nav-menu--header">
      <div class="c-nav-menu__media c-nav-menu__media--service">
        <img
            class="c-nav-menu__img c-nav-menu__img--service"
            src="{{ imgSrc }}"
            srcset="{{ imgSrcset }}"
            sizes="{{ imgSizes }}"
            alt="{{ title }}"
        />
        {% if iconField and iconField.url %}
          <img
              class="c-nav-menu__icon c-nav-menu__icon--service"
              src="{{ iconField.url }}"
              alt="{{ title }} icon"
          />
        {% endif %}
      </div>
      <h3 class="c-nav-menu__heading c-nav-menu__heading--service">{{ title }}</h3>
      </header>
      <div class="c-nav-menu__body c-nav-menu__body--service">
        {% if intro %}
          <p class="c-nav-menu__intro c-nav-menu__intro--service">{{ intro }}</p>
        {% endif %}
        {% if contentFld %}
          <div class="c-nav-menu__content c-nav-menu__content--service">
            {{ contentFld|raw }}
          </div>
        {% endif %}
        {# only show link label if not hidden #}
        {% if not hideLink %}
          <div class="c-nav-menu__footer">
            <div class="c-btn--more"><span class="c-btn__link--more"><span class="c-btn__link-label--more">{{ linkLabel }}</span></span></div>

              </div>
        {% endif %}
      </div>
      </{{ wrapperTag }}>
      </li>
    {% endfor %}
  </ul>
</div>
